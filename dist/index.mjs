var M=Object.defineProperty;var y=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var x=(n,o,r)=>o in n?M(n,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[o]=r,g=(n,o)=>{for(var r in o||(o={}))v.call(o,r)&&x(n,r,o[r]);if(y)for(var r of y(o))A.call(o,r)&&x(n,r,o[r]);return n};import*as l from"vite";import S from"javascript-obfuscator";var p=class{constructor(o){this.show=o;this._log=o?console.log.bind(console):this.noop}noop(o){}forceLog(...o){console.log(...o)}info(o){this._log(o)}};function h(n){let o=Math.floor(n/36e5),r=Math.floor(n%36e5/6e4),c=Math.floor(n%6e4/1e3);return[o?`${o}h `:"",r?`${r}m `:"",c||!o&&!r?`${c}s`:""].filter(Boolean).join("")}function k(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function F(n){return Object.prototype.toString.call(n)==="[object String]"}function m(n){return Object.prototype.toString.call(n)==="[object Object]"}function C(n){return Array.isArray(n)}function O(n){return Object.prototype.toString.call(n)==="[object Function]"}function j(n,o){for(let r of o)if(k(r)){if(r.test(n))return!0}else if(F(r)&&n.includes(r))return!0;return!1}var E={excludes:[],enable:!0,log:!0,apply:"build",autoExcludeNodeModules:!1,options:{compact:!0,controlFlowFlattening:!0,controlFlowFlatteningThreshold:1,deadCodeInjection:!1,debugProtection:!1,debugProtectionInterval:0,disableConsoleOutput:!1,identifierNamesGenerator:"hexadecimal",log:!1,numbersToExpressions:!1,renameGlobals:!1,selfDefending:!0,simplify:!0,splitStrings:!1,stringArray:!1,stringArrayCallsTransform:!1,stringArrayCallsTransformThreshold:.5,stringArrayEncoding:[],stringArrayIndexShift:!0,stringArrayRotate:!0,stringArrayShuffle:!0,stringArrayWrappersCount:1,stringArrayWrappersChainedCalls:!0,stringArrayWrappersParametersMaxCount:2,stringArrayWrappersType:"variable",stringArrayThreshold:.75,unicodeEscapeSequence:!1}},u="vendor-modules",d=Object.freeze({info:"\x1B[36m",warn:"\x1B[33m"});function L(){return l!=null&&l.version?Number(l.version.split(".")[0]):2}function R(n){let o=g(g({},E),n),r=new p(o.log),c=e=>{if(!o.enable||!o.autoExcludeNodeModules)return;e.build=e.build||{},e.build.rollupOptions=e.build.rollupOptions||{};let{output:t}=e.build.rollupOptions,f=a=>{if(o.excludes.push(u),a.includes("node_modules"))return u};if(!t){e.build.rollupOptions.output={manualChunks:f};return}if(C(t)){r.forceLog(d.warn,"rollupOptions.output is an array, ignoring autoExcludeNodeModules configuration.");return}if(m(t)){if(!t.manualChunks)t.manualChunks=f;else if(m(t.manualChunks))r.forceLog(d.warn,"rollupOptions.output.manualChunks is an object, ignoring autoExcludeNodeModules configuration.");else if(O(t.manualChunks)){let a=t.manualChunks;o.excludes.push(u),t.manualChunks=(i,s)=>i.includes("node_modules")?u:a(i,s)}}},b=(e,{bundle:t})=>{if(!o.enable||!t)return e;let f=performance.now();r.forceLog("starting obfuscation process..."),Object.entries(t).forEach(([i,s])=>{"code"in s&&s.code&&!j(i,o.excludes)&&(r.info(`obfuscating ${i}...`),s.code=S.obfuscate(s.code,o.options).getObfuscatedCode(),r.info(`obfuscation complete for ${i}.`))});let a=h(performance.now()-f);return r.forceLog(d.info+"%s\x1B[0m %s","\u2713",`obfuscation process completed in ${a}.`),e};return{name:"vite-plugin-bundle-obfuscator",apply:o.apply,config:c,transformIndexHtml:L()>=5?{order:"post",handler:b}:{enforce:"post",transform:b}}}export{R as default};
